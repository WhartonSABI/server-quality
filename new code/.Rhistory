data = subset_m_second, family = "binomial")
summary(logit_model_m) ## p_server_beats_returner significant *** (pos coef)
subset_m
# get rid of p_server_beats_returner
subset_m <- subset(subset_m, select = -c(p_server_beats_returner, p_server_beats_returner.1))
subset_f <- subset(subset_f, select = -c(p_server_beats_returner, p_server_beats_returner.1))
subset_f
## male
subset_m <- subset_m %>%
mutate(p_server_beats_returner <- ifelse(PointServer == 1,
1 / (1 + exp(welo_p1_bt - welo_p2_bt)),
1 / (1 + exp(welo_p2_bt - welo_p1_bt))))
# rename column in subset_m
setnames(subset_m, old = c("... <- NULL"),
new = c("p_server_beats_returner"))
subset_m
View(subset_m)
write.csv(subset_m, "../data/wimbledon_subset_m.csv", row.names = FALSE)
# new models with just second serves
subset_m_second <- subset_m[ServeNumber == 2]
subset_f_second <- subset_f[ServeNumber == 2]
## logistic regression for serving_player_won vs. p_server_beats_returner
logit_model_m <- glm(serving_player_won ~ p_server_beats_returner,
data = subset_m_second, family = "binomial")
summary(logit_model_m) ## p_server_beats_returner significant *** (pos coef)
## female
subset_f <- subset_f %>%
mutate(p_server_beats_returner <- ifelse(PointServer == 1,
1 / (1 + exp(welo_p1_bt - welo_p2_bt)),
1 / (1 + exp(welo_p2_bt - welo_p1_bt))))
# rename column in subset_f
setnames(subset_f, old = c("... <- NULL"),
new = c("p_server_beats_returner"))
subset_f
write.csv(subset_f, "../data/wimbledon_subset_f.csv", row.names = FALSE)
rm(list=ls())
# install.packages("fastDummies")
library(welo)
library(tidyverse)
library(data.table)
library(ggplot2)
library(reshape2)
subset_m <- as.data.table(read.csv("../data/wimbledon_subset_m.csv"))
subset_f <- as.data.table(read.csv("../data/wimbledon_subset_f.csv"))
names(subset_m)
subset_m_second <- subset_m[ServeNumber == 2]
subset_f_second <- subset_f[ServeNumber == 2]
## corr matrix male
numerical_x_cols <- c("p_server_beats_returner", "ElapsedSeconds_fixed", "importance", "speed_ratio")
subset_m_x <- subset_m_second %>% select(all_of(numerical_x_cols))
cor_matrix <- cor(subset_m_x, use = "complete.obs", method = "pearson")
cor_melt <- melt(cor_matrix)
ggplot(cor_melt, aes(x = Var1, y = Var2, fill = value)) +
geom_tile(color = "white") +
geom_text(aes(label = round(value, 2)), size = 3) +  # Add correlation values
scale_fill_gradient2(low = "blue", high = "red", mid = "white",
midpoint = 0, limit = c(-1, 1), name = "Correlation") +
labs(x = "", y = "", title = "Correlation Matrix with Coefficients") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
# include categorical variables
subset_m_dummies <- subset_m_second %>%
mutate(across(c(ServeWidth, ServeDepth), as.factor)) %>%
fastDummies::dummy_cols(select_columns = c("ServeWidth", "ServeDepth"), remove_first_dummy = TRUE, remove_selected_columns = TRUE)
subset_m_all <- subset_m_dummies %>%
select(all_of(numerical_x_cols), starts_with("ServeWidth_"), starts_with("ServeDepth_"))
cor_matrix <- cor(subset_m_all, use = "complete.obs", method = "pearson")
cor_melt <- melt(cor_matrix)
ggplot(cor_melt, aes(x = Var1, y = Var2, fill = value)) +
geom_tile(color = "white") +
geom_text(aes(label = round(value, 2)), size = 3) +  # Add correlation values
scale_fill_gradient2(low = "blue", high = "red", mid = "white",
midpoint = 0, limit = c(-1, 1), name = "Correlation") +
labs(x = "", y = "", title = "Correlation Matrix with Coefficients") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggsave("../images/corr_matrix_male.png", bg = "white",
width = 8, height = 6, units = "in")
## corr matrix female
numerical_x_cols <- c("p_server_beats_returner", "ElapsedSeconds_fixed", "importance", "speed_ratio")
subset_f_x <- subset_f_second %>% select(all_of(numerical_x_cols))
cor_matrix <- cor(subset_f_x, use = "complete.obs", method = "pearson")
cor_melt <- melt(cor_matrix)
ggplot(cor_melt, aes(x = Var1, y = Var2, fill = value)) +
geom_tile(color = "white") +
geom_text(aes(label = round(value, 2)), size = 3) +  # Add correlation values
scale_fill_gradient2(low = "blue", high = "red", mid = "white",
midpoint = 0, limit = c(-1, 1), name = "Correlation") +
labs(x = "", y = "", title = "Correlation Matrix with Coefficients") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
# include categorical variables
subset_f_dummies <- subset_f_second %>%
mutate(across(c(ServeWidth, ServeDepth), as.factor)) %>%
fastDummies::dummy_cols(select_columns = c("ServeWidth", "ServeDepth"), remove_first_dummy = TRUE, remove_selected_columns = TRUE)
subset_f_all <- subset_f_dummies %>%
select(all_of(numerical_x_cols), starts_with("ServeWidth_"), starts_with("ServeDepth_"))
cor_matrix <- cor(subset_f_all, use = "complete.obs", method = "pearson")
cor_melt <- melt(cor_matrix)
ggplot(cor_melt, aes(x = Var1, y = Var2, fill = value)) +
geom_tile(color = "white") +
geom_text(aes(label = round(value, 2)), size = 3) +  # Add correlation values
scale_fill_gradient2(low = "blue", high = "red", mid = "white",
midpoint = 0, limit = c(-1, 1), name = "Correlation") +
labs(x = "", y = "", title = "Correlation Matrix with Coefficients") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggsave("../images/corr_matrix_female.png", bg = "white",
width = 8, height = 6, units = "in")
rm(list=ls())
# install.packages("welo")
library(welo)
library(tidyverse)
library(data.table)
library(ggplot2)
subset_m <- as.data.table(read.csv("../data/wimbledon_subset_m.csv"))
subset_f <- as.data.table(read.csv("../data/wimbledon_subset_f.csv"))
names(subset_m)
# new models with just second serves
subset_m_second <- subset_m[ServeNumber == 2]
subset_f_second <- subset_f[ServeNumber == 2]
## logistic regression for serving_player_won vs. p_server_beats_returner
logit_model_m <- glm(serving_player_won ~ p_server_beats_returner,
data = subset_m_second, family = "binomial")
summary(logit_model_m) ## p_server_beats_returner significant *** (pos coef)
logit_model_f <- glm(serving_player_won ~ p_server_beats_returner,
data = subset_f_second, family = "binomial")
summary(logit_model_f) ## not significant
logit_model_2_m <- glm(serving_player_won ~ p_server_beats_returner + ElapsedSeconds,
data = subset_m_second, family = "binomial")
summary(logit_model_2_m) ## p_server_beats_returner significant *** (pos coef), ElapsedSeconds not significant
logit_model_2_m <- glm(serving_player_won ~ p_server_beats_returner + ElapsedSeconds_fixed,
data = subset_m_second, family = "binomial")
summary(logit_model_2_m) ## p_server_beats_returner significant *** (pos coef), ElapsedSeconds not significant
logit_model_2_f <- glm(serving_player_won ~ p_server_beats_returner + ElapsedSeconds_fixed,
data = subset_f_second, family = "binomial")
summary(logit_model_2_f) ## neither significant
## add second serve speed ratio
logit_model_3_m <- glm(serving_player_won ~ p_server_beats_returner + ElapsedSeconds_fixed + speed_ratio,
data = subset_m_second, family = "binomial")
summary(logit_model_3_m) ## p_server_beats_returner significant *** (pos coef), ElapsedSeconds not significant, speed_ratio not significant
logit_model_3_f <- glm(serving_player_won ~ p_server_beats_returner + ElapsedSeconds_fixed + speed_ratio,
data = subset_f_second, family = "binomial")
summary(logit_model_3_f) ## nothing significant
## add score importance
logit_model_4_m <- glm(serving_player_won ~ p_server_beats_returner + ElapsedSeconds_fixed + speed_ratio + importance,
data = subset_m_second, family = "binomial")
summary(logit_model_4_m) ## p_server_beats_returner significant *** (pos coef), nothing else significant. but intercept is significant *** (neg coef)
logit_model_4_f <- glm(serving_player_won ~ p_server_beats_returner + ElapsedSeconds_fixed + speed_ratio + importance,
data = subset_f_second, family = "binomial")
summary(logit_model_4_f) ## nothing significant
## add location of serve
logit_model_5_m <- glm(serving_player_won ~ p_server_beats_returner + ElapsedSeconds_fixed + importance + speed_ratio + factor(ServeWidth) + factor(ServeDepth),
data = subset_m_second, family = "binomial")
summary(logit_model_5_m) ## p_server_beats_returner significant *** (pos coef), nothing else significant
logit_model_5_f <- glm(serving_player_won ~ p_server_beats_returner + ElapsedSeconds_fixed + importance + speed_ratio + factor(ServeWidth) + factor(ServeDepth),
data = subset_f_second, family = "binomial")
summary(logit_model_5_f) ## nothing significant
rm(list=ls())
# install.packages("welo")
library(welo)
library(tidyverse)
library(data.table)
library(ggplot2)
subset_m <- as.data.table(read.csv("../data/wimbledon_subset_m.csv"))
subset_f <- as.data.table(read.csv("../data/wimbledon_subset_f.csv"))
names(subset_m)
# new models with just first serves
subset_m_first <- subset_m[ServeNumber == 1]
subset_f_first <- subset_f[ServeNumber == 1]
## logistic regression for serving_player_won vs. p_server_beats_returner
logit_model_m <- glm(serving_player_won ~ p_server_beats_returner,
data = subset_f_first, family = "binomial")
summary(logit_model_m) ## p_server_beats_returner significant *** (pos coef)
logit_model_f <- glm(serving_player_won ~ p_server_beats_returner,
data = subset_f_first, family = "binomial")
summary(logit_model_f) ## not significant
logit_model_2_m <- glm(serving_player_won ~ p_server_beats_returner + ElapsedSeconds_fixed,
data = subset_m_first, family = "binomial")
summary(logit_model_2_m) ## p_server_beats_returner significant *** (pos coef), ElapsedSeconds significant ** (neg coef)
rm(list=ls())
# install.packages("welo")
library(welo)
library(tidyverse)
library(data.table)
library(ggplot2)
subset_m <- as.data.table(read.csv("../data/wimbledon_subset_m.csv"))
subset_f <- as.data.table(read.csv("../data/wimbledon_subset_f.csv"))
names(subset_m)
# remove p_server_beats_returner
subset_m <- subset_m %>%
select(-p_server_beats_returner)
# remove p_server_beats_returner
subset_f <- subset_f %>%
select(-p_server_beats_returner)
## male
subset_m <- subset_m %>%
mutate(p_server_beats_returner <- ifelse(PointServer == 1,
1 / (1 + exp(welo_p1_bt - welo_p2_bt)),
1 / (1 + exp(welo_p2_bt - welo_p1_bt))))
# remove p_server_beats_returner
subset_m <- subset_m %>%
select(-p_server_beats_returner)
## male
subset_m <- subset_m %>%
mutate(p_server_beats_returner <- ifelse(PointServer == 1,
1 / (1 + exp(welo_p1_bt - welo_p2_bt)),
1 / (1 + exp(welo_p2_bt - welo_p1_bt))))
# rename column in subset_m
setnames(subset_m, old = c("... <- NULL"),
new = c("p_server_beats_returner"))
subset_m
View(subset_m)
## male
subset_m <- subset_m %>%
mutate(p_server_beats_returner <- ifelse(PointServer == 1,
1 / (1 + exp(welo_p1_bt - welo_p2_bt)),
1 / (1 + exp(welo_p2_bt - welo_p1_bt))))
subset_m
# remove p_server_beats_returner
setnames(subset_m, old = c("... <- NULL"),
new = c("p_server_beats_returner"))
# remove p_server_beats_returner
subset_m[, p_server_beats_returner := NULL]
write.csv(subset_m, "../data/wimbledon_subset_m.csv", row.names = FALSE)
rm(list=ls())
# install.packages("welo")
library(welo)
library(tidyverse)
library(data.table)
library(ggplot2)
subset_m <- as.data.table(read.csv("../data/wimbledon_subset_m.csv"))
# Convert ELO to logistic (Bradley-Terry scale)
subset_m[, welo_p1_bt := 0.0057565 * player1_avg_welo]
subset_m[, welo_p2_bt := 0.0057565 * player2_avg_welo]
## male
subset_m <- subset_m %>%
mutate(p_server_beats_returner <- ifelse(PointServer == 1,
1 / (1 + exp(welo_p2_bt - welo_p1_bt)),
1 / (1 + exp(welo_p1_bt - welo_p2_bt))))
setnames(subset_f, old = c("... <- NULL"),
new = c("p_server_beats_returner"))
setnames(subset_m, old = c("... <- NULL"),
new = c("p_server_beats_returner"))
write.csv(subset_m, "../data/wimbledon_subset_m.csv", row.names = FALSE)
View(subset_m)
subset_f <- as.data.table(read.csv("../data/wimbledon_subset_f.csv"))
View(subset_m)
subset_m
# get rid of p_server_beats_returner
subset_m <- subset_m %>%
select(-p_server_beats_returner)
names(subset_m)
## male
subset_m <- subset_m %>%
mutate(p_server_beats_returner <- ifelse(PointServer == 1,
1 / (1 + exp(welo_p2_bt - welo_p1_bt)),
1 / (1 + exp(welo_p1_bt - welo_p2_bt))))
setnames(subset_m, old = c("... <- NULL"),
new = c("p_server_beats_returner"))
write.csv(subset_m, "../data/wimbledon_subset_m.csv", row.names = FALSE)
View(subset_f)
# get rid of p_server_beats_returner
subset_f <- subset_f %>%
select(-p_server_beats_returner)
## female
subset_f <- subset_f %>%
mutate(p_server_beats_returner <- ifelse(PointServer == 1,
1 / (1 + exp(welo_p2_bt - welo_p1_bt)),
1 / (1 + exp(welo_p1_bt - welo_p2_bt))))
# rename column in subset_f
setnames(subset_f, old = c("... <- NULL"),
new = c("p_server_beats_returner"))
write.csv(subset_f, "../data/wimbledon_subset_f.csv", row.names = FALSE)
rm(list=ls())
# install.packages("welo")
library(welo)
library(tidyverse)
library(data.table)
library(ggplot2)
subset_m <- as.data.table(read.csv("../data/wimbledon_subset_m.csv"))
subset_f <- as.data.table(read.csv("../data/wimbledon_subset_f.csv"))
names(subset_m)
# new models with just first serves
subset_m_first <- subset_m[ServeNumber == 1]
subset_f_first <- subset_f[ServeNumber == 1]
## logistic regression for serving_player_won vs. p_server_beats_returner
logit_model_m <- glm(serving_player_won ~ p_server_beats_returner,
data = subset_f_first, family = "binomial")
summary(logit_model_m) ## not significant
logit_model_f <- glm(serving_player_won ~ p_server_beats_returner,
data = subset_f_first, family = "binomial")
summary(logit_model_f) ## not significant
logit_model_2_m <- glm(serving_player_won ~ p_server_beats_returner + ElapsedSeconds_fixed,
data = subset_m_first, family = "binomial")
summary(logit_model_2_m) ## p_server_beats_returner significant *** (pos coef), ElapsedSeconds significant ** (neg coef)
logit_model_2_f <- glm(serving_player_won ~ p_server_beats_returner + ElapsedSeconds_fixed,
data = subset_f_first, family = "binomial")
summary(logit_model_2_f) ## neither significant
## add second serve speed ratio
logit_model_3_m <- glm(serving_player_won ~ p_server_beats_returner + ElapsedSeconds_fixed + speed_ratio,
data = subset_m_second, family = "binomial")
## add second serve speed ratio
logit_model_3_m <- glm(serving_player_won ~ p_server_beats_returner + ElapsedSeconds_fixed + speed_ratio,
data = subset_f_first, family = "binomial")
summary(logit_model_3_m) ## p_server_beats_returner significant *** (pos coef), ElapsedSeconds significant ** (neg coef), speed_ratio not significant
logit_model_3_f <- glm(serving_player_won ~ p_server_beats_returner + ElapsedSeconds_fixed + speed_ratio,
data = subset_f_first, family = "binomial")
summary(logit_model_3_f) ## nothing significant
## add second serve speed ratio
logit_model_3_m <- glm(serving_player_won ~ p_server_beats_returner + ElapsedSeconds_fixed + speed_ratio,
data = subset_f_first, family = "binomial")
## add second serve speed ratio
logit_model_3_m <- glm(serving_player_won ~ p_server_beats_returner + ElapsedSeconds_fixed + speed_ratio,
data = subset_m_first, family = "binomial")
summary(logit_model_3_m) ## p_server_beats_returner and ElapsedSeconds not significant ***, but speed_ratio significant * (pos coef)
logit_model_2_m <- glm(serving_player_won ~ p_server_beats_returner + ElapsedSeconds_fixed,
data = subset_m_first, family = "binomial")
summary(logit_model_2_m) ## p_server_beats_returner significant *** (pos coef), ElapsedSeconds significant ** (neg coef)
# new models with just first serves
subset_m_first <- subset_m[ServeNumber == 1]
subset_f_first <- subset_f[ServeNumber == 1]
## logistic regression for serving_player_won vs. p_server_beats_returner
logit_model_m <- glm(serving_player_won ~ p_server_beats_returner,
data = subset_f_first, family = "binomial")
summary(logit_model_m) ## not significant
logit_model_f <- glm(serving_player_won ~ p_server_beats_returner,
data = subset_f_first, family = "binomial")
summary(logit_model_f) ## not significant
logit_model_2_m <- glm(serving_player_won ~ p_server_beats_returner + ElapsedSeconds_fixed,
data = subset_m_first, family = "binomial")
summary(logit_model_2_m) ## p_server_beats_returner significant *** (pos coef), ElapsedSeconds significant ** (neg coef)
logit_model_2_f <- glm(serving_player_won ~ p_server_beats_returner + ElapsedSeconds_fixed,
data = subset_f_first, family = "binomial")
summary(logit_model_2_f) ## neither significant
## add second serve speed ratio
logit_model_3_m <- glm(serving_player_won ~ p_server_beats_returner + ElapsedSeconds_fixed + speed_ratio,
data = subset_m_first, family = "binomial")
summary(logit_model_3_m) ## nothing except p_server_beats_returner significant *** (pos coef)
logit_model_3_f <- glm(serving_player_won ~ p_server_beats_returner + ElapsedSeconds_fixed + speed_ratio,
data = subset_f_first, family = "binomial")
summary(logit_model_3_f) ## p_server_beats_returner and ElapsedSeconds not significant ***, but speed_ratio significant * (pos coef)
## add score importance
logit_model_4_m <- glm(serving_player_won ~ p_server_beats_returner + ElapsedSeconds_fixed + speed_ratio + importance,
data = subset_m_first, family = "binomial")
summary(logit_model_4_m) ## p_server_beats_returner significant *** (pos coef), ElapsedSeconds significant ** (neg coef), speed_ratio and importance not significant
logit_model_4_f <- glm(serving_player_won ~ p_server_beats_returner + ElapsedSeconds_fixed + speed_ratio + importance,
data = subset_f_first, family = "binomial")
summary(logit_model_4_f) ## nothing significant
## add location of serve
logit_model_5_m <- glm(serving_player_won ~ p_server_beats_returner + ElapsedSeconds_fixed + importance + speed_ratio + factor(ServeWidth) + factor(ServeDepth),
data = subset_m_first, family = "binomial")
summary(logit_model_5_m) ## p_server_beats_returner significant *** (pos coef), ElapsedSeconds significant ** (neg coef), speed_ratio & importance & serve location not significant
logit_model_5_f <- glm(serving_player_won ~ p_server_beats_returner + ElapsedSeconds_fixed + importance + speed_ratio + factor(ServeWidth) + factor(ServeDepth),
data = subset_f_first, family = "binomial")
summary(logit_model_5_f) ## nothing significant
# new models with just second serves
subset_m_second <- subset_m[ServeNumber == 2]
subset_f_second <- subset_f[ServeNumber == 2]
## logistic regression for serving_player_won vs. p_server_beats_returner
logit_model_m <- glm(serving_player_won ~ p_server_beats_returner,
data = subset_m_second, family = "binomial")
summary(logit_model_m) ## p_server_beats_returner significant *** (pos coef)
logit_model_f <- glm(serving_player_won ~ p_server_beats_returner,
data = subset_f_second, family = "binomial")
summary(logit_model_f) ## not significant
logit_model_2_m <- glm(serving_player_won ~ p_server_beats_returner + ElapsedSeconds_fixed,
data = subset_m_second, family = "binomial")
summary(logit_model_2_m) ## p_server_beats_returner significant *** (pos coef), ElapsedSeconds significant ** (neg coef)
logit_model_2_f <- glm(serving_player_won ~ p_server_beats_returner + ElapsedSeconds_fixed,
data = subset_f_second, family = "binomial")
summary(logit_model_2_f) ## neither significant
## add second serve speed ratio
logit_model_3_m <- glm(serving_player_won ~ p_server_beats_returner + ElapsedSeconds_fixed + speed_ratio,
data = subset_m_second, family = "binomial")
# get rid of p_server_beats_returner
subset_m <- subset_m %>%
select(-p_server_beats_returner)
# get rid of p_server_beats_returner
subset_f <- subset_f %>%
select(-p_server_beats_returner)
names(subset_m)
names(subset_f)
write.csv(subset_m, "../data/wimbledon_subset_m.csv", row.names = FALSE)
write.csv(subset_f, "../data/wimbledon_subset_f.csv", row.names = FALSE)
rm(list=ls())
# install.packages("welo")
library(welo)
library(tidyverse)
library(data.table)
library(ggplot2)
subset_m <- as.data.table(read.csv("../data/wimbledon_subset_m.csv"))
subset_f <- as.data.table(read.csv("../data/wimbledon_subset_f.csv"))
names(subset_f)
# Convert ELO to logistic (Bradley-Terry scale)
subset_m[, welo_p1_bt := 0.0057565 * player1_avg_welo]
names(subset_m)
## male
subset_m <- subset_m %>%
mutate(p_server_beats_returner <- ifelse(PointServer == 1,
1 / (1 + exp(welo_p1_bt - welo_p2_bt)),
1 / (1 + exp(welo_p2_bt - welo_p1_bt))))
setnames(subset_m, old = c("... <- NULL"),
new = c("p_server_beats_returner"))
names(subset_m)
write.csv(subset_m, "../data/wimbledon_subset_m.csv", row.names = FALSE)
## female
subset_f <- subset_f %>%
mutate(p_server_beats_returner <- ifelse(PointServer == 1,
1 / (1 + exp(welo_p1_bt - welo_p2_bt)),
1 / (1 + exp(welo_p2_bt - welo_p1_bt))))
# rename column in subset_f
setnames(subset_f, old = c("... <- NULL"),
new = c("p_server_beats_returner"))
write.csv(subset_f, "../data/wimbledon_subset_f.csv", row.names = FALSE)
# new models with just second serves
subset_m_second <- subset_m[ServeNumber == 2]
subset_f_second <- subset_f[ServeNumber == 2]
## logistic regression for serving_player_won vs. p_server_beats_returner
logit_model_m <- glm(serving_player_won ~ p_server_beats_returner,
data = subset_m_second, family = "binomial")
summary(logit_model_m) ## p_server_beats_returner significant *** (neg coef)
summary(logit_model_m) ## p_server_beats_returner significant *** (pos coef)
logit_model_f <- glm(serving_player_won ~ p_server_beats_returner,
data = subset_f_second, family = "binomial")
summary(logit_model_f) ## not significant
logit_model_2_m <- glm(serving_player_won ~ p_server_beats_returner + ElapsedSeconds_fixed,
data = subset_m_second, family = "binomial")
summary(logit_model_2_m) ## p_server_beats_returner significant *** (neg coef), ElapsedSeconds significant ** (neg coef)
logit_model_2_f <- glm(serving_player_won ~ p_server_beats_returner + ElapsedSeconds_fixed,
data = subset_f_second, family = "binomial")
summary(logit_model_2_f) ## neither significant
## add second serve speed ratio
logit_model_3_m <- glm(serving_player_won ~ p_server_beats_returner + ElapsedSeconds_fixed + speed_ratio,
data = subset_m_second, family = "binomial")
summary(logit_model_3_m) ## p_server_beats_returner significant *** (pos coef), ElapsedSeconds significant ** (neg coef), speed_ratio not significant
logit_model_3_f <- glm(serving_player_won ~ p_server_beats_returner + ElapsedSeconds_fixed + speed_ratio,
data = subset_f_second, family = "binomial")
summary(logit_model_3_f) ## nothing significant
## add score importance
logit_model_4_m <- glm(serving_player_won ~ p_server_beats_returner + ElapsedSeconds_fixed + speed_ratio + importance,
data = subset_m_second, family = "binomial")
summary(logit_model_4_m) ## p_server_beats_returner significant *** (pos coef), ElapsedSeconds significant ** (neg coef), speed_ratio and importance not significant
logit_model_4_f <- glm(serving_player_won ~ p_server_beats_returner + ElapsedSeconds_fixed + speed_ratio + importance,
data = subset_f_second, family = "binomial")
summary(logit_model_4_f) ## nothing significant
## add location of serve
logit_model_5_m <- glm(serving_player_won ~ p_server_beats_returner + ElapsedSeconds_fixed + importance + speed_ratio + factor(ServeWidth) + factor(ServeDepth),
data = subset_m_second, family = "binomial")
summary(logit_model_5_m) ## p_server_beats_returner significant *** (pos coef), ElapsedSeconds significant ** (neg coef), speed_ratio & importance & serve location not significant
logit_model_5_f <- glm(serving_player_won ~ p_server_beats_returner + ElapsedSeconds_fixed + importance + speed_ratio + factor(ServeWidth) + factor(ServeDepth),
data = subset_f_second, family = "binomial")
summary(logit_model_5_f) ## nothing significant
rm(list=ls())
# install.packages("welo")
library(welo)
library(tidyverse)
library(data.table)
library(ggplot2)
subset_m <- as.data.table(read.csv("../data/wimbledon_subset_m.csv"))
subset_f <- as.data.table(read.csv("../data/wimbledon_subset_f.csv"))
names(subset_m)
# new models with just first serves
subset_m_first <- subset_m[ServeNumber == 1]
subset_f_first <- subset_f[ServeNumber == 1]
## logistic regression for serving_player_won vs. p_server_beats_returner
logit_model_m <- glm(serving_player_won ~ p_server_beats_returner,
data = subset_f_first, family = "binomial")
summary(logit_model_m) ## not significant
logit_model_f <- glm(serving_player_won ~ p_server_beats_returner,
data = subset_f_first, family = "binomial")
summary(logit_model_f) ## not significant
logit_model_2_m <- glm(serving_player_won ~ p_server_beats_returner + ElapsedSeconds_fixed,
data = subset_m_first, family = "binomial")
summary(logit_model_2_m) ## p_server_beats_returner significant *** (pos coef), ElapsedSeconds not significant
logit_model_2_f <- glm(serving_player_won ~ p_server_beats_returner + ElapsedSeconds_fixed,
data = subset_f_first, family = "binomial")
summary(logit_model_2_f) ## neither significant
## add second serve speed ratio
logit_model_3_m <- glm(serving_player_won ~ p_server_beats_returner + ElapsedSeconds_fixed + speed_ratio,
data = subset_m_first, family = "binomial")
summary(logit_model_3_m) ## p_server_beats_returner significant *** (pos coef), nothing else significant
logit_model_3_f <- glm(serving_player_won ~ p_server_beats_returner + ElapsedSeconds_fixed + speed_ratio,
data = subset_f_first, family = "binomial")
summary(logit_model_3_f) ## p_server_beats_returner and ElapsedSeconds not significant, but speed_ratio significant * (pos coef)
## add score importance
logit_model_4_m <- glm(serving_player_won ~ p_server_beats_returner + ElapsedSeconds_fixed + speed_ratio + importance,
data = subset_m_first, family = "binomial")
summary(logit_model_4_m) ## p_server_beats_returner significant *** (pos coef), nothing else significant
logit_model_4_f <- glm(serving_player_won ~ p_server_beats_returner + ElapsedSeconds_fixed + speed_ratio + importance,
data = subset_f_first, family = "binomial")
summary(logit_model_4_f) ## p_server_beats_returner and ElapsedSeconds not significant, but speed_ratio significant * (pos coef). importance not significant.
## add location of serve
logit_model_5_m <- glm(serving_player_won ~ p_server_beats_returner + ElapsedSeconds_fixed + importance + speed_ratio + factor(ServeWidth) + factor(ServeDepth),
data = subset_m_first, family = "binomial")
summary(logit_model_5_m) ## p_server_beats_returner significant *** (pos coef), nothing else significant
summary(logit_model_5_m) ## p_server_beats_returner significant *** (neg coef), nothing else significant
logit_model_5_f <- glm(serving_player_won ~ p_server_beats_returner + ElapsedSeconds_fixed + importance + speed_ratio + factor(ServeWidth) + factor(ServeDepth),
data = subset_f_first, family = "binomial")
summary(logit_model_5_f) ## servewidth BW and C significant (*, **) with neg coefs, but nothing else significant
rm(list=ls())
# install.packages("welo")
library(welo)
library(tidyverse)
library(data.table)
library(ggplot2)
subset_m <- as.data.table(read.csv("../data/wimbledon_subset_m.csv"))
subset_f <- as.data.table(read.csv("../data/wimbledon_subset_f.csv"))
names(subset_m)
m_one_rally <- subset_m %>%
filter(RallyCount == 1)
View(m_one_rally)
